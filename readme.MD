# Scraper ML

Sistema de web scraping e inteligÃªncia de mercado para o Mercado Livre. Utiliza **Python**, **Playwright** e **SQLite** para monitoramento de preÃ§os, anÃ¡lise de concorrÃªncia e extraÃ§Ã£o de detalhes tÃ©cnicos.

O sistema opera em dois estÃ¡gios principais: Busca (Search) para descobrir produtos e Enriquecimento (Detail) para extrair dados profundos (descriÃ§Ã£o, caracterÃ­sticas tÃ©cnicas, histÃ³rico de reviews e dados do vendedor).

## ğŸ“‹ Funcionalidades

- **Busca Automatizada**: Varre mÃºltiplas pÃ¡ginas de busca por termos especÃ­ficos e coleta, volume de vendas, posicao, avaliaÃ§Ã£o, etc.
- **ExtraÃ§Ã£o de Detalhes (Deep Crawl):** Acessa a pÃ¡gina de cada produto para coletar:

    - Ficha tÃ©cnica completa (JSON).
    - DescriÃ§Ã£o completa e Resumo IA (se disponÃ­vel).
    - Dados do Vendedor (NÃ­vel, Vendas totais, Loja Oficial). 
    - AnÃ¡lise de Reviews: Coleta a data do Ãºltimo review e contagem de reviews nos Ãºltimos 90 dias para medir a "saÃºde" e velocidade de vendas do produto.

- **Anti-Bot & Stealth**: Utiliza rotaÃ§Ã£o de User-Agents e remove flags do WebDriver para evitar bloqueios.
- **Banco de Dados Estruturado**: Salva tudo em SQLite relacional (products e sellers).
- **Filtros Inteligentes**: Permite enriquecer apenas produtos que atendam a critÃ©rios (ex: PreÃ§o mÃ­nimo, Nota mÃ­nima, Apenas novos).

## ğŸ“‚ Estrutura do Projeto
```
.
â”œâ”€â”€ main.py                 # Ponto de entrada (CLI)
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ database.py         # Gerenciamento do SQLite e Models
â”‚   â”œâ”€â”€ search_scraper.py   # Bot de Busca (Lista de produtos)
â”‚   â””â”€â”€ detail_scraper.py   # Bot de Detalhes (PÃ¡gina do produto)
â”œâ”€â”€ data/
â”‚   â””â”€â”€ ml_intelligence.db  # Banco de dados gerado (automÃ¡tico)
â””â”€â”€ README.md
```

## ğŸ›  InstalaÃ§Ã£o

Requer Python 3.8+.

```bash
# 1. Instale as dependÃªncias
pip install playwright pandas

# 2. Instale os binÃ¡rios do navegador
playwright install chromium
```

##  ğŸš€ Como Usar
O ponto de entrada Ã© o arquivo main.py.

###  1. Modo Busca (`search`)
Apenas descobre produtos e salva dados bÃ¡sicos (PreÃ§o, Link, ID, PosiÃ§Ã£o).

```bash
python main.py --mode search --terms "iphone 15" "samsung s24" --pages 3
```
### 2. Modo Detalhe (`detail`)
Percorre o banco de dados para enriquecer produtos jÃ¡ descobertos.

```bash
# Detalhar apenas produtos novos (nunca visitados)
python main.py --mode detail --only-new --limit 50

# Detalhar produtos acima de R$ 100 com nota mÃ­nima 4.5
python main.py --mode detail --min-price 100 --min-rating 4.5
```

### 3. Modo Completo (`full`)
Executa a busca e, em seguida, o detalhamento dos itens encontrados.

```bash
python main.py --mode full --terms "cadeira gamer" --pages 2 --limit 20
```

### âš™ï¸ Argumentos da CLI

| Argumento | DescriÃ§Ã£o | PadrÃ£o |
| :--- | :--- | :--- |
| `--mode` | `search`, `detail` ou `full`. | `full` |
| `--terms` | Termos para busca (ObrigatÃ³rio em `search`/`full`). | - |
| `--pages` | PÃ¡ginas a percorrer por termo na busca. | `3` |
| `--limit` | Limite de produtos a processar no modo detalhe. | `20` |
| `--only-new` | Flag: Processa apenas itens sem detalhes no banco. | `False` |
| `--min-price` | Filtro: PreÃ§o mÃ­nimo para enriquecimento. | `0.0` |
| `--days-since-update`| Filtro: Reprocessar itens nÃ£o atualizados hÃ¡ X dias. | `0` |

## ğŸ“‚ Estrutura do Banco de Dados

Os dados sÃ£o salvos em `data/ml_intelligence.db`.

- Tabela `products`: ContÃ©m dados de busca (`price`, `permalink`) e detalhes (`specifications_json`, `comments_last_90d`, `ai_summary`).

- Tabela `sellers`: ContÃ©m reputaÃ§Ã£o e histÃ³rico de vendas dos vendedores.

Para carregar os dados em Pandas:

```python
from src.database import carregar_dados_produtos,  carregar_dados_vendedor

df_p = carregar_dados_produtos()
df_s = carregar_dados_vendedor()
```

## âš ï¸ Aviso Legal
Este software foi compartilhado para fins educacionais e portifolio. O uso excessivo de scrapers pode violar os Termos de ServiÃ§o do Mercado Livre.

- Use com moderaÃ§Ã£o (respeite os time.sleep implementados).
- NÃ£o utilize para ataques de negaÃ§Ã£o de serviÃ§o.
- **O autor nÃ£o se responsabiliza** pelo uso indevido da ferramenta.
- Use pelo seu prÃ³rpio risco e responsabilidade


